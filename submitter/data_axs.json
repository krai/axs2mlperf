{
    "power": false,

    "sut_description_query": ["^^", "substitute", ["sut_description,sut=#{sut_name}#"]],
    "sut_description_entry": [ "^", "byquery", [[ "^^", "get", "sut_description_query" ]], {}, ["sut_description_query"] ],
    "sut_description": [ "^^", "execute", [[
        [ "get", "sut_description_entry" ],
        [ "get", "data" ]
    ]] ],
    "sut_path": [ "^^", "execute", [[
	    [ "get", "sut_description_entry" ],
	    [ "get_path",[]]
    ]]],
    "sut_system_type": [ "^^", "dig", "sut_description.system_type" ],
    "task": [ "^^", "task_from_program_name" ],
    "scenarios": [ "^^", "scenarios_from_sut_type_and_task" ],

    "division": "open",
    "submitter": "Krai",
    "record_entry_name": "laid_out_submission",
    "model_name_dict": { "retinanet_openimages": "retinanet", "bert_large": "bert-99" },

    "model_name2dataset_size": {
        "resnet50": 50000,
        "retinanet": 24781,
        "retinanet_openimages": 24781,
        "retinanet_coco": 5000,
        "bert-99": 10833,
        "bert-99.9": 10833
    },
    "model_name2buffer_size": {
        "resnet50": 1024,
        "retinanet": 64,
        "retinanet_openimages": 64,
        "retinanet_coco": 64,
        "bert-99": 10833,
        "bert-99.9": 10833
    },

    "program_entry": [ "^^", "execute", [[
        [ "get_kernel" ],
        [ "byname", [ "^^", "get", "program_name" ] ]
    ]] ],
    "loadgen_dataset_size": [ "^^", "dig", [["model_name2dataset_size", ["^^", "get", "model_name"] ]] ],
    "loadgen_buffer_size": [ "^^", "dig", [["model_name2buffer_size", ["^^", "get", "model_name"] ]] ],
    "experiment_tags": [ "^^", "dig", "program_entry.output_entry_tags" ],
    "framework": [ "^^", "dig", "program_entry.framework" ],
    "device": [ "^^", "execute", [[
        [ "get", "program_entry" ],
        [ "get", ["device", null] ]
    ]] ],

    "experiment_entries": ["^^", "list_experiment_entries", [], { "generate": true } ],

    "mlperf_inference_git_entry": [ "^", "byquery", "git_repo,repo_name=mlperf_inference_git" ],

    "log_truncation_script_path": [ "^^", "execute", [[
        [ "get", "mlperf_inference_git_entry" ],
        [ "get_path", [["tools", "submission", "truncate_accuracy_log.py"]] ]
    ]], {}, ["mlperf_inference_git_entry"] ],
    "submission_checker_path": [ "^^", "execute", [[
        [ "get", "mlperf_inference_git_entry" ],
        [ "get_path", [["tools", "submission", "submission_checker.py"]] ]
    ]], {}, ["mlperf_inference_git_entry"] ],

    "compliance_path": [ "^^", "execute", [[
        [ "get", "mlperf_inference_git_entry" ],
        [ "get_path", [["compliance", "nvidia"]] ]
    ]], {}, ["mlperf_inference_git_entry"] ],

    "desired_python_version": ["^", "kernel_python_major_dot_minor"],
    "python_tool_entry": [ "^", "byquery", [[ "shell_tool", "can_python", ["desired_python_version", ["^^", "get", "desired_python_version"]] ]], {}, ["desired_python_version"] ],

    "run_verify": [ "^^", "execute", [[
        [ "get_kernel" ],
        [ "byname", "python_script" ],
        [ "run", [], {
            "desired_python_version": [ "^^", "get", "desired_python_version" ],
            "python_deps": [
                [ "AS^IS", "^^", "python_sync_pip_package", "python_package,package_name=numpy" ]
            ],
            "abs_script_path": ["^^", "get", "verify_script_path"],
            "script_extra_params": [ "^^", "substitute", "--results_dir \"#{results_dir}#\" --compliance_dir \"#{compliance_dir}#\" --output_dir \"#{output_dir}#\" " ],
            "capture_output": false,
            "capture_stderr": true,
            "results_dir": [ "^^", "get", "results_dir" ],
            "compliance_dir": [ "^^", "get", "compliance_dir" ],
            "output_dir": [ "^^", "get", "output_dir" ]
        } ]
    ]] ],

    "run_truncation_script": [ "^^", "execute", [[
            [ "get", "python_tool_entry" ],
            [ "run", [], {
            "shell_cmd_with_subs": "\"#{tool_path}#\" #{log_truncation_script_path}# --input #{submitted_tree_path}# --submitter #{submitter}# --backup #{log_backup_path}#",
            "capture_output": false,
            "capture_stderr": false,
            "log_truncation_script_path": ["^^", "get", "log_truncation_script_path" ],
            "submitted_tree_path": [ "^^", "get", "submitted_tree_path" ],
            "submitter": [ "^^", "get", "submitter" ],
            "log_backup_path": [ "^^", "get", "log_backup_path" ]
            } ]
        ]]
    ],
    "run_checker_script": [ "^^", "execute", [[
            [ "get", "python_tool_entry" ],
            [ "run", [], {
            "shell_cmd_with_subs": "\"#{tool_path}#\" #{submission_checker_path}# --input #{submitted_tree_path}# --csv /dev/null",
            "capture_output": false,
            "capture_stderr": true,
            "submission_checker_path":["^^", "get", "submission_checker_path" ],
            "submitted_tree_path": ["^^", "get", "submitted_tree_path" ]
            } ]
       ]]
    ],

    "submission_entry_name": [ "^^", "substitute", "laid_out_submission_#{division}#_#{program_name}#_on_#{sut_name}#" ],
    "submission_entry": [ "^^", "execute", [[
        [ "get", "__record_entry__" ],
        [ "set_path", [ "^^", "get", "submission_entry_name" ] ],
        [ "attach", [ "^", "work_collection" ] ],
        [ "plant", [
            "tags", [ "laid_out_submission" ]
          ] ],
        [ "save" ]
    ]] ],
    "submitted_tree_path": [ "^^", "execute", [[
        [ "get", "submission_entry" ],
        [ "get_path", "submitted_tree" ]
    ]] ]
}
