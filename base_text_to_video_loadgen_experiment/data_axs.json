{
    "_parent_entries": [ [ "^", "byname", "base_loadgen_experiment" ] ],

    "mlperf_inference_git_entry": [ "^", "byquery", "git_repo,repo_name=mlperf_inference_git" ],

    "launch_script_path": [ "^^", "execute", [[
        [ "get", "mlperf_inference_git_entry" ],
        [ "get_path_of", "text_to_video_reference_script" ]
    ]] ],

    "dataset_file_name": "vbench_prompts.txt",
    "dataset_path": [ "^^", "execute", [[
        [ "get", "mlperf_inference_git_entry" ],
        [ "get_path", [[ "text_to_video", "wan2.2-t2v-14b", "data", [ "^^", "get", "dataset_file_name" ] ]] ]
    ]] ],
    "output_path": [ "^^", "get_path"],
    "videos_relative_path": "videos",
    "accuracy_log_path": ["^^", "get_path", "mlperf_log_accuracy.json"],
    "videos_path": [ "^^", "get_videos_path" ],
    "num_gpus": 8,

    "build_container": [ "^^", "substitute", "#{launch_script_path}# --build" ],
    "accuracy_script_name": "run_evaluation.py",
    "docker_videos_path": "/videos",
    "docker_output_path": "/output",
    "volumes": [ "^^", "substitute", "-v #{videos_path}#:#{docker_videos_path}# -v #{output_path}#:#{docker_output_path}#" ],
    "run_accuracy_script": [ "^^", "substitute", "#{launch_script_path}# #{volumes}# python3 #{accuracy_script_name}# --videos-path #{docker_videos_path}# --output-path #{docker_output_path}# --num-gpus #{num_gpus}#" ],

    "extract_accuracy_report": [ "^^", "execute", [[
        [ "get_kernel" ],
        [ "byname", "shell" ],
        [ "run", [], {
                "envs": {
                    "GPU_COUNT": 0
                },
                "shell_cmd": [ "^^", "substitute", "#{build_container}# && #{run_accuracy_script}#" ],
                "capture_output": true
            } ],
        0,
        [ "func", [ "ufun.rematch", "(\\{.*\\})" ] ],
        0,
        [ "denumpify_dict" ],
        0,
        [ "func", "str" ]
    ]], {} ]
}
